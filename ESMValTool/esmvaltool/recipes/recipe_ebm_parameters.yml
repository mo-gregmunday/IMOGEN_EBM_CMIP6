# ESMValTool
# recipe_jules_variable_extract.yml
---
documentation:
  description: Extracting mean variables over monthly timescales to feed IMOGEN
  title: Generating Climate Patterns

  authors:
    - munday_gregory

preprocessors:
  global_mean_monthly:
    monthly_statistics:
      operator: mean

    regrid:
      target_grid: {start_longitude: -180, end_longitude: 176.25, step_longitude: 3.75,
                    start_latitude: -55, end_latitude: 82.5, step_latitude: 2.5}
      scheme: linear

  mean_annual:
    annual_statistics:
      operator: mean

annual_mean_settings: &annual_mean_settings
  mip: Amon
  project: CMIP6
  preprocessor: mean_annual

CMIP6_LANDFRAC: &cmip6_landfrac
  - {dataset: ACCESS-CM2,      exp: piControl,    ensemble: r1i1p1f1, grid: gn,  institute: CSIRO-ARCCSS}
  - {dataset: ACCESS-ESM1-5,   exp: piControl,    ensemble: r1i1p1f1, grid: gn}
  - {dataset: AWI-CM-1-1-MR,   exp: piControl,    ensemble: r1i1p1f1, grid: gn}
  # - {dataset: BCC-CSM2-MR,        exp: 1pctCO2,      ensemble: r1i1p1f1, grid: gn}
  - {dataset: CanESM5-CanOE,   exp: piControl,    ensemble: r1i1p2f1, grid: gn}
  - {dataset: CanESM5,         exp: piControl,    ensemble: r1i1p1f1, grid: gn}
  - {dataset: CanESM5-1,       exp: piControl,    ensemble: r1i1p1f1, grid: gn}
  # - {dataset: CAS-ESM2-0,      exp: piControl,    ensemble: r1i1p1f1, grid: gn}
  - {dataset: CMCC-ESM2,       exp: piControl,    ensemble: r1i1p1f1, grid: gn}
  - {dataset: CMCC-CM2-SR5,    exp: piControl,    ensemble: r1i1p1f1, grid: gn}
  - {dataset: CNRM-CM6-1,      exp: piControl,    ensemble: r1i1p1f2, grid: gr}
  - {dataset: CNRM-CM6-1-HR,   exp: piControl,    ensemble: r1i1p1f2, grid: gr}
  - {dataset: CNRM-ESM2-1,     exp: piControl,    ensemble: r1i1p1f2, grid: gr}
  - {dataset: EC-Earth3,       exp: piControl,    ensemble: r1i1p1f1, grid: gr}
  # - {dataset: EC-Earth3-CC,    exp: piControl,    ensemble: r1i1p1f1, grid: gr}
  - {dataset: EC-Earth3-Veg,   exp: piControl,    ensemble: r1i1p1f1, grid: gr}
  - {dataset: FGOALS-f3-L,     exp: historical,   ensemble: r1i1p1f1, grid: gr}
  - {dataset: FGOALS-g3,       exp: piControl,    ensemble: r1i1p1f1, grid: gn}
  # - {dataset: FIO-ESM-2-0,     exp: piControl,    ensemble: r1i1p1f1, grid: gn}
  # - {dataset: GFDL-CM4,        exp: piControl,    ensemble: r1i1p1f1, grid: gr1}
  - {dataset: GFDL-ESM4,       exp: ssp370,       ensemble: r1i1p1f1, grid: gr1}
  - {dataset: GISS-E2-1-G,     exp: piControl,    ensemble: r1i1p1f1, grid: gn}
  - {dataset: GISS-E2-1-H,     exp: piControl,    ensemble: r1i1p1f1, grid: gn}
  - {dataset: GISS-E2-2-G,     exp: piControl,    ensemble: r1i1p1f1, grid: gn}
  - {dataset: HadGEM3-GC31-LL, exp: piControl,    ensemble: r1i1p1f1, grid: gn}
  - {dataset: HadGEM3-GC31-MM, exp: piControl,    ensemble: r1i1p1f1, grid: gn}
  - {dataset: INM-CM5-0,       exp: abrupt-4xCO2, ensemble: r1i1p1f1, grid: gr1}
  - {dataset: INM-CM4-8,       exp: piControl,    ensemble: r1i1p1f1, grid: gr1}
  - {dataset: IPSL-CM6A-LR,    exp: piControl,    ensemble: r1i1p1f1, grid: gr}
  - {dataset: MIROC6,          exp: piControl,    ensemble: r1i1p1f1, grid: gn}
  - {dataset: MIROC-ES2L,      exp: piControl,    ensemble: r1i1p1f2, grid: gn}
  - {dataset: MPI-ESM1-2-HR,   exp: piControl,    ensemble: r1i1p1f1, grid: gn}
  - {dataset: MPI-ESM1-2-LR,   exp: piControl,    ensemble: r1i1p1f1, grid: gn}
  - {dataset: MRI-ESM2-0,      exp: piControl,    ensemble: r1i1p1f1, grid: gn}
  - {dataset: NorESM2-LM,      exp: piControl,    ensemble: r1i1p1f1, grid: gn}
  - {dataset: NorESM2-MM,      exp: piControl,    ensemble: r1i1p1f1, grid: gn}
  - {dataset: TaiESM1,         exp: piControl,    ensemble: r1i1p1f1, grid: gn}
  - {dataset: UKESM1-0-LL,     exp: piControl,    ensemble: r1i1p1f2, grid: gn}

CMIP6_FULL: &cmip6_585
  - {dataset: ACCESS-CM2,      exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gn, institute: CSIRO-ARCCSS}
  - {dataset: ACCESS-ESM1-5,   exp: [historical, ssp585], ensemble: r3i1p1f1,  grid: gn,}
  - {dataset: AWI-CM-1-1-MR,   exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gn,}
  # - {dataset: BCC-CSM2-MR,     exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gn}
  - {dataset: CanESM5-CanOE,   exp: [historical, ssp585], ensemble: r1i1p2f1,  grid: gn,}
  - {dataset: CanESM5,         exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gn,}
  - {dataset: CanESM5-1,       exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gn,}
  # - {dataset: CAS-ESM2-0,      exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gn}
  - {dataset: CMCC-ESM2,       exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gn}
  - {dataset: CMCC-CM2-SR5,    exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gn,}
  - {dataset: CNRM-CM6-1,      exp: [historical, ssp585], ensemble: r1i1p1f2,  grid: gr,}
  - {dataset: CNRM-CM6-1-HR,   exp: [historical, ssp585], ensemble: r1i1p1f2,  grid: gr,}
  - {dataset: CNRM-ESM2-1,     exp: [historical, ssp585], ensemble: r1i1p1f2,  grid: gr,}
  - {dataset: EC-Earth3-Veg,   exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gr,}
  # - {dataset: EC-Earth3-CC,    exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gr}
  - {dataset: EC-Earth3,       exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gr,}
  - {dataset: FGOALS-f3-L,     exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gr,}
  - {dataset: FGOALS-g3,       exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gn,}
  # - {dataset: FIO-ESM-2-0,     exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gn}
  # - {dataset: GFDL-CM4,        exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gr1}
  - {dataset: GFDL-ESM4,       exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gr1}
  - {dataset: GISS-E2-1-G,     exp: [historical, ssp585], ensemble: r1i1p3f1,  grid: gn,}
  - {dataset: GISS-E2-1-H,     exp: [historical, ssp585], ensemble: r3i1p1f2,  grid: gn,}
  - {dataset: GISS-E2-2-G,     exp: [historical, ssp585], ensemble: r1i1p3f1,  grid: gn}
  - {dataset: HadGEM3-GC31-LL, exp: [historical, ssp585], ensemble: r1i1p1f3,  grid: gn,}
  - {dataset: HadGEM3-GC31-MM, exp: [historical, ssp585], ensemble: r1i1p1f3,  grid: gn,}
  - {dataset: INM-CM4-8,       exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gr1}
  - {dataset: INM-CM5-0,       exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gr1}
  - {dataset: IPSL-CM6A-LR,    exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gr,}
  - {dataset: MIROC6,          exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gn,}
  - {dataset: MIROC-ES2L,      exp: [historical, ssp585], ensemble: r1i1p1f2,  grid: gn,}
  - {dataset: MPI-ESM1-2-HR,   exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gn,}
  - {dataset: MPI-ESM1-2-LR,   exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gn,}
  - {dataset: MRI-ESM2-0,      exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gn,}
  - {dataset: NorESM2-LM,      exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gn,}
  - {dataset: NorESM2-MM,      exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gn,}
  - {dataset: TaiESM1,         exp: [historical, ssp585], ensemble: r1i1p1f1,  grid: gn,}
  - {dataset: UKESM1-0-LL,     exp: [historical, ssp585], ensemble: r1i1p1f2,  grid: gn,}

CMIP6_126: &cmip6_126
  - {dataset: ACCESS-CM2,      exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gn, institute: CSIRO-ARCCSS}
  - {dataset: ACCESS-ESM1-5,   exp: [historical, ssp126], ensemble: r3i1p1f1,  grid: gn,}
  - {dataset: AWI-CM-1-1-MR,   exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gn,}
  # - {dataset: BCC-CSM2-MR,     exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gn}
  - {dataset: CanESM5-CanOE,   exp: [historical, ssp126], ensemble: r1i1p2f1,  grid: gn,}
  - {dataset: CanESM5,         exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gn,}
  - {dataset: CanESM5-1,       exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gn,}
  # - {dataset: CAS-ESM2-0,      exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gn}
  - {dataset: CMCC-ESM2,       exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gn}
  - {dataset: CMCC-CM2-SR5,    exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gn,}
  - {dataset: CNRM-CM6-1,      exp: [historical, ssp126], ensemble: r1i1p1f2,  grid: gr,}
  - {dataset: CNRM-CM6-1-HR,   exp: [historical, ssp126], ensemble: r1i1p1f2,  grid: gr,}
  - {dataset: CNRM-ESM2-1,     exp: [historical, ssp126], ensemble: r1i1p1f2,  grid: gr,}
  - {dataset: EC-Earth3-Veg,   exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gr,}
  # - {dataset: EC-Earth3-CC,    exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gr}
  - {dataset: EC-Earth3,       exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gr,}
  - {dataset: FGOALS-f3-L,     exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gr,}
  - {dataset: FGOALS-g3,       exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gn,}
  # - {dataset: FIO-ESM-2-0,     exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gn}
  # - {dataset: GFDL-CM4,        exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gr1}
  - {dataset: GFDL-ESM4,       exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gr1}
  - {dataset: GISS-E2-1-G,     exp: [historical, ssp126], ensemble: r1i1p3f1,  grid: gn,}
  - {dataset: GISS-E2-1-H,     exp: [historical, ssp126], ensemble: r3i1p1f2,  grid: gn,}
  - {dataset: GISS-E2-2-G,     exp: [historical, ssp126], ensemble: r1i1p3f1,  grid: gn}
  - {dataset: HadGEM3-GC31-LL, exp: [historical, ssp126], ensemble: r1i1p1f3,  grid: gn,}
  - {dataset: HadGEM3-GC31-MM, exp: [historical, ssp126], ensemble: r1i1p1f3,  grid: gn,}
  - {dataset: INM-CM4-8,       exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gr1}
  - {dataset: INM-CM5-0,       exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gr1}
  - {dataset: IPSL-CM6A-LR,    exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gr,}
  - {dataset: MIROC6,          exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gn,}
  - {dataset: MIROC-ES2L,      exp: [historical, ssp126], ensemble: r1i1p1f2,  grid: gn,}
  - {dataset: MPI-ESM1-2-HR,   exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gn,}
  - {dataset: MPI-ESM1-2-LR,   exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gn,}
  - {dataset: MRI-ESM2-0,      exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gn,}
  - {dataset: NorESM2-LM,      exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gn,}
  - {dataset: NorESM2-MM,      exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gn,}
  - {dataset: TaiESM1,         exp: [historical, ssp126], ensemble: r1i1p1f1,  grid: gn,}
  - {dataset: UKESM1-0-LL,     exp: [historical, ssp126], ensemble: r1i1p1f2,  grid: gn,}

diagnostics:
  annual_timeseries:
    description: Mean annual TOA fluxes and tas

    variables:
      land_frac:
        short_name: sftlf
        mip: fx
        project: CMIP6
        additional_datasets: *cmip6_landfrac

      tas_585:
        short_name: tas
        <<: *annual_mean_settings
        additional_datasets: *cmip6_585
        start_year: 1850
        end_year: 2100

      rlut_585:
        short_name: rlut
        <<: *annual_mean_settings
        additional_datasets: *cmip6_585
        start_year: 1850
        end_year: 2100

      rsut_585:
        short_name: rsut
        <<: *annual_mean_settings
        additional_datasets: *cmip6_585
        start_year: 1850
        end_year: 2100

      rsdt_585:
        short_name: rsdt
        <<: *annual_mean_settings
        additional_datasets: *cmip6_585
        start_year: 1850
        end_year: 2100

      tas_126:
        short_name: tas
        <<: *annual_mean_settings
        additional_datasets: *cmip6_126
        start_year: 1850
        end_year: 2100

      rlut_126:
        short_name: rlut
        <<: *annual_mean_settings
        additional_datasets: *cmip6_126
        start_year: 1850
        end_year: 2100

      rsut_126:
        short_name: rsut
        <<: *annual_mean_settings
        additional_datasets: *cmip6_126
        start_year: 1850
        end_year: 2100

      rsdt_126:
        short_name: rsdt
        <<: *annual_mean_settings
        additional_datasets: *cmip6_126
        start_year: 1850
        end_year: 2100

    scripts:
      energy_balance_script:
        script: ebm_parameters/ebm_parameters.py
        include_params: off # options: on, off
        parallelise: on # options: on, off
        parallel_threads: 32 # int, optional
        forcing_ssp126: /home/h04/gmunday/Desktop/CSSPBrazil/ESMVal/IMOGEN_EBM_CMIP6/ESMValTool/esmvaltool/diag_scripts/ebm_parameters/ssp126_ERF_1750-2500_best_estimate.csv
        forcing_ssp585: /home/h04/gmunday/Desktop/CSSPBrazil/ESMVal/IMOGEN_EBM_CMIP6/ESMValTool/esmvaltool/diag_scripts/ebm_parameters/ssp585_ERF_1750-2500_best_estimate.csv
